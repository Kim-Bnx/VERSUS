{"version":3,"file":"actions.mjs","sources":["../../src/actions/actions.ts"],"sourcesContent":["import { useEffect, useLayoutEffect } from 'react';\nimport type {\n  SetFieldValue,\n  SetValues,\n  SetInitialValues,\n  SetErrors,\n  SetFieldError,\n  ClearFieldError,\n  ClearErrors,\n  Reset,\n  ValidateField,\n  RemoveListItem,\n  ReorderListItem,\n  InsertListItem,\n  SetFormStatus,\n  ResetDirty,\n  ResetStatus,\n  UseFormReturnType,\n  _TransformValues,\n} from '../types';\n\nfunction dispatchEvent(type: string, detail?: any): any {\n  window.dispatchEvent(new CustomEvent(type, { detail }));\n}\n\nfunction validateFormName(name: string) {\n  if (!/^[0-9a-zA-Z-]+$/.test(name)) {\n    throw new Error(\n      `[@mantine/use-form] Form name \"${name}\" is invalid, it should contain only letters, numbers and dashes`\n    );\n  }\n}\n\nexport const useIsomorphicEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\nexport function createFormActions<FormValues extends Record<string, any> = Record<string, any>>(\n  name: string\n) {\n  validateFormName(name);\n\n  const setFieldValue: SetFieldValue<FormValues> = (path, value) =>\n    dispatchEvent(`mantine-form:${name}:set-field-value`, { path, value });\n\n  const setValues: SetValues<FormValues> = (values) =>\n    dispatchEvent(`mantine-form:${name}:set-values`, values);\n\n  const setInitialValues: SetInitialValues<FormValues> = (values) =>\n    dispatchEvent(`mantine-form:${name}:set-initial-values`, values);\n\n  const setErrors: SetErrors = (errors) => dispatchEvent(`mantine-form:${name}:set-errors`, errors);\n\n  const setFieldError: SetFieldError<FormValues> = (path, error) =>\n    dispatchEvent(`mantine-form:${name}:set-field-error`, { path, error });\n\n  const clearFieldError: ClearFieldError = (path) =>\n    dispatchEvent(`mantine-form:${name}:clear-field-error`, path);\n\n  const clearErrors: ClearErrors = () => dispatchEvent(`mantine-form:${name}:clear-errors`);\n\n  const reset: Reset = () => dispatchEvent(`mantine-form:${name}:reset`);\n\n  const validate: () => void = () => dispatchEvent(`mantine-form:${name}:validate`);\n\n  const validateField: ValidateField<FormValues> = (path) =>\n    dispatchEvent(`mantine-form:${name}:validate-field`, path);\n\n  const reorderListItem: ReorderListItem<FormValues> = (path, payload) =>\n    dispatchEvent(`mantine-form:${name}:reorder-list-item`, { path, payload });\n\n  const removeListItem: RemoveListItem<FormValues> = (path, index) =>\n    dispatchEvent(`mantine-form:${name}:remove-list-item`, { path, index });\n\n  const insertListItem: InsertListItem<FormValues> = (path, item, index) =>\n    dispatchEvent(`mantine-form:${name}:insert-list-item`, { path, index, item });\n\n  const setDirty: SetFormStatus = (value) => dispatchEvent(`mantine-form:${name}:set-dirty`, value);\n\n  const setTouched: SetFormStatus = (value) =>\n    dispatchEvent(`mantine-form:${name}:set-touched`, value);\n\n  const resetDirty: ResetDirty<FormValues> = (values) =>\n    dispatchEvent(`mantine-form:${name}:reset-dirty`, values);\n\n  const resetTouched: ResetStatus = () => dispatchEvent(`mantine-form:${name}:reset-touched`);\n\n  return {\n    setFieldValue,\n    setValues,\n    setInitialValues,\n    setErrors,\n    setFieldError,\n    clearFieldError,\n    clearErrors,\n    reset,\n    validate,\n    validateField,\n    reorderListItem,\n    removeListItem,\n    insertListItem,\n    setDirty,\n    setTouched,\n    resetDirty,\n    resetTouched,\n  };\n}\n\nfunction useFormEvent(eventKey: string | undefined, handler: Function) {\n  useIsomorphicEffect(() => {\n    if (eventKey) {\n      window.addEventListener(eventKey, handler as any);\n      return () => window.removeEventListener(eventKey, handler as any);\n    }\n    return undefined;\n  }, [eventKey]);\n}\n\nexport function useFormActions<\n  Values = Record<string, unknown>,\n  TransformValues extends _TransformValues<Values> = (values: Values) => Values,\n>(name: string | undefined, form: UseFormReturnType<Values, TransformValues>) {\n  if (name) {\n    validateFormName(name);\n  }\n\n  useFormEvent(`mantine-form:${name}:set-field-value`, (event: CustomEvent) =>\n    form.setFieldValue(event.detail.path, event.detail.value)\n  );\n\n  useFormEvent(`mantine-form:${name}:set-values`, (event: CustomEvent) =>\n    form.setValues(event.detail)\n  );\n\n  useFormEvent(`mantine-form:${name}:set-initial-values`, (event: CustomEvent) =>\n    form.setInitialValues(event.detail)\n  );\n\n  useFormEvent(`mantine-form:${name}:set-errors`, (event: CustomEvent) =>\n    form.setErrors(event.detail)\n  );\n\n  useFormEvent(`mantine-form:${name}:set-field-error`, (event: CustomEvent) =>\n    form.setFieldError(event.detail.path, event.detail.error)\n  );\n\n  useFormEvent(`mantine-form:${name}:clear-field-error`, (event: CustomEvent) =>\n    form.clearFieldError(event.detail)\n  );\n\n  useFormEvent(`mantine-form:${name}:clear-errors`, form.clearErrors);\n  useFormEvent(`mantine-form:${name}:reset`, form.reset);\n  useFormEvent(`mantine-form:${name}:validate`, form.validate);\n\n  useFormEvent(`mantine-form:${name}:validate-field`, (event: CustomEvent) =>\n    form.validateField(event.detail)\n  );\n\n  useFormEvent(`mantine-form:${name}:reorder-list-item`, (event: CustomEvent) =>\n    form.reorderListItem(event.detail.path, event.detail.payload)\n  );\n\n  useFormEvent(`mantine-form:${name}:remove-list-item`, (event: CustomEvent) =>\n    form.removeListItem(event.detail.path, event.detail.index)\n  );\n\n  useFormEvent(`mantine-form:${name}:insert-list-item`, (event: CustomEvent) =>\n    form.insertListItem(event.detail.path, event.detail.item, event.detail.index)\n  );\n\n  useFormEvent(`mantine-form:${name}:set-dirty`, (event: CustomEvent) =>\n    form.setDirty(event.detail)\n  );\n\n  useFormEvent(`mantine-form:${name}:set-touched`, (event: CustomEvent) =>\n    form.setTouched(event.detail)\n  );\n\n  useFormEvent(`mantine-form:${name}:reset-dirty`, (event: CustomEvent) =>\n    form.resetDirty(event.detail)\n  );\n\n  useFormEvent(`mantine-form:${name}:reset-touched`, form.resetTouched);\n}\n"],"names":[],"mappings":"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"}